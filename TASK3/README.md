# Лабораторная работа 3: Построение панорамных изображений

## Описание

Реализация алгоритма склейки панорамных изображений **без использования готового класса `cv2.Stitcher`**.

## Структура проекта

```
lab3/
├── lab3_.py              # Основной скрипт
├── task3/                # Папка с исходными изображениями
│   ├── map1/            # Первый набор изображений
│   ├── map2/            # Второй набор изображений
│   └── map3/            # Третий набор изображений
├── panorama_map1.jpg    # Результат для map1
├── panorama_map2.jpg    # Результат для map2
└── panorama_map3.jpg    # Результат для map3
```

## Требования

- Python 3.6+
- OpenCV (cv2)
- NumPy

Установка зависимостей:
```bash
pip install opencv-python numpy
```

## Использование

Запустите скрипт из папки `lab3/`:

```bash
python lab3_.py
```

Скрипт автоматически:
1. Обработает все три набора изображений (map1, map2, map3)
2. Построит панорамы для каждого набора
3. Сохранит результаты в папке `task3/` как `panorama_map1.jpg`, `panorama_map2.jpg`, `panorama_map3.jpg`

## Алгоритм

1. **Поиск особых точек**: Используется SIFT (Scale-Invariant Feature Transform) или ORB как fallback
2. **Сопоставление признаков**: KNN-матчинг с ratio-test для фильтрации ложных совпадений
3. **Оценка гомографии**: RANSAC для устойчивой оценки проективного преобразования
4. **Проективное преобразование**: Применение гомографии через `warpPerspective`
5. **Смешивание**: Градиентный blending в зоне перекрытия для плавных переходов
6. **Оптимизация порядка**: Выбор лучшего стартового кадра и склейка в обе стороны

## Результаты

Итоговые панорамы сохраняются в папке `task3/`:
- `panorama_map1.jpg` - панорама первого набора
- `panorama_map2.jpg` - панорама второго набора  
- `panorama_map3.jpg` - панорама третьего набора

## Примечания

- Алгоритм автоматически определяет оптимальный порядок склейки для каждого набора
- При недостаточном количестве надёжных соответствий используется аффинное преобразование как fallback
- Чёрные поля по краям автоматически обрезаются

